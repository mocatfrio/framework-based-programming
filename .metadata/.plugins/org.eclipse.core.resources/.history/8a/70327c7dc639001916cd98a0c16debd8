package com.example.json_to_pojo;

import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStream;
import java.io.InputStreamReader;
import java.io.Reader;
import java.net.HttpURLConnection;
import java.net.URL;
import java.net.URLConnection;

import com.google.gson.Gson;
import com.google.gson.GsonBuilder;

public class BookResponse {
	//	download the json as text
	private static String readUrl (String urlString, String isbn) throws IOException {
	    BufferedReader reader = null;
	    try {
	        URL url = new URL(urlString + isbn);
	        reader = new BufferedReader(new InputStreamReader(url.openStream()));
	        StringBuffer buffer = new StringBuffer();
	        int read;
	        char[] chars = new char[1024];
	        while ((read = reader.read(chars)) != -1)
	            buffer.append(chars, 0, read); 

	        return buffer.toString();
	    } finally {
	        if (reader != null)
	            reader.close();
	    }
	}
	public static void main(String[] args) throws IOException {
		String isbn;
		
		InputStreamReader isr = new InputStreamReader(System.in);
		BufferedReader br = new BufferedReader(isr);
		
		System.out.println("### Pencarian buku berdasarkan ISBN ###");
		System.out.print("Masukkan ISBN: ");
		isbn = br.readLine();
		
//		System.out.println(endpointApi + isbn);
		
//		String json = readUrl(endpointApi, isbn);
//		Gson gson = new GsonBuilder().create();
//        Book book = gson.fromJson(json, Book.class);
//        System.out.println(book);
        
        URL url = new URL("https://www.booknomads.com/api/v0/isbn/" + isbn);
        HttpURLConnection connection = (HttpURLConnection) url.openConnection();
        connection.setRequestMethod("GET");
        connection.connect();

        BufferedReader json  = new BufferedReader(new InputStreamReader(connection.getInputStream()));          

        memberClass memberClass = new Gson().fromJson(json, memberClass.class);

            System.out.println("Id: " + memberClass.getMember().get(1).getId());  
        }
    }
}

